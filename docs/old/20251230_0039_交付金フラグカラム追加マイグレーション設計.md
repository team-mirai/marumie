# 交付金フラグカラム追加マイグレーション設計

## 概要

`transactions` テーブルに交付金フラグ（`is_grant_expenditure`）カラムを追加するマイグレーションの設計。

## 背景

[docs/20251229_2237_交付金フラグ実装設計.md](20251229_2237_交付金フラグ実装設計.md) で決定した方針に基づき、各支出トランザクションに「交付金に係る支出」フラグを追加する。

## スキーマ変更

### Prismaスキーマ

`prisma/schema.prisma` の `Transaction` モデルに以下を追加：

```prisma
isGrantExpenditure  Boolean  @default(false) @map("is_grant_expenditure")
```

### SQLマイグレーション

```sql
ALTER TABLE "public"."transactions"
ADD COLUMN "is_grant_expenditure" BOOLEAN NOT NULL DEFAULT false;
```

## マイグレーション手順

1. `prisma/schema.prisma` を編集
2. `pnpm prisma migrate dev --name add_grant_expenditure_flag` を実行
3. 生成されたマイグレーションSQLを確認

## 既存データの扱い

- 全ての既存レコードは `is_grant_expenditure = false` となる
- `branch-grants-expenses` からの移行データについては、別途データ移行作業で `true` に更新する（本マイグレーションのスコープ外）

## 備考

- カラム追加のみの単純なマイグレーションのため、ダウンタイムは発生しない
- `DEFAULT false` によりNOT NULL制約を安全に追加可能
