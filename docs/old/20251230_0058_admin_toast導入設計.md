# admin Toast 導入設計

## 概要

admin アプリケーションに toast 通知機能を導入する。ユーザーアクション（保存、削除、エラー等）のフィードバックを視覚的に提供する。

## ライブラリ選定

### 採用: sonner

| 評価項目 | sonner | 備考 |
|---------|--------|------|
| shadcn/ui 親和性 | ◎ | shadcn/ui 公式推奨ライブラリ |
| バンドルサイズ | ◎ | ~3KB (gzip) |
| 依存関係 | ◎ | なし（Radix 不要） |
| React 19 対応 | ◎ | 対応済み |
| TypeScript | ◎ | 完全対応 |
| ダークモード | ◎ | テーマ対応あり |
| API シンプルさ | ◎ | `toast("message")` で呼び出し可能 |

### 比較検討した代替案

| ライブラリ | 不採用理由 |
|-----------|-----------|
| react-hot-toast | shadcn/ui 公式は sonner を推奨 |
| @radix-ui/react-toast | 設定が複雑、sonner の方がシンプル |

## 実装設計

### ファイル構成

```
admin/src/
├── app/
│   └── layout.tsx              # Toaster コンポーネント配置
├── client/
│   └── components/
│       └── ui/
│           ├── sonner.tsx      # Toaster ラッパー（新規）
│           └── index.ts        # re-export 追加
```

### Toaster コンポーネント

`admin/src/client/components/ui/sonner.tsx` に Toaster ラッパーを作成する。

ポイント:
- admin は Dark Blue テーマ（ダークモード固定）のため、`theme="dark"` を指定
- 既存の CSS 変数（`--color-*`）を活用してスタイルを統一
- shadcn/ui の sonner コンポーネントをベースに、admin のテーマに合わせてカスタマイズ

### レイアウトへの配置

`admin/src/app/layout.tsx` の `<body>` 直下に `<Toaster />` を配置する。

配置位置: `{children}` の後、`<SpeedInsights />` の前

### 呼び出し方法

actions や Client Components から直接 `toast()` を呼び出す。

基本パターン:
- 成功: `toast.success("保存しました")`
- エラー: `toast.error("エラーが発生しました")`
- 情報: `toast("処理中...")`
- Promise: `toast.promise(asyncFn(), { loading, success, error })`

### ダークモード対応

sonner の `theme="dark"` プロパティを使用する。追加で以下の CSS 変数をオーバーライドして admin のテーマと統一する:

- `--normal-bg`: `var(--color-card)`
- `--normal-text`: `var(--color-card-foreground)`
- `--normal-border`: `var(--color-border)`
- `--success-bg`, `--error-bg` 等も同様に調整

## ガイドライン更新

`docs/admin-ui-guidelines.md` に Toast の使用方法セクションを追加する。

追加内容:
- インポート方法
- 基本的な使用例
- Promise パターンの使用例
- action からの呼び出し時の注意点

## チェックリスト

- [ ] sonner パッケージのインストール
- [ ] `admin/src/client/components/ui/sonner.tsx` の作成
- [ ] `admin/src/client/components/ui/index.ts` への re-export 追加
- [ ] `admin/src/app/layout.tsx` への Toaster 配置
- [ ] ダークモードスタイルの調整
- [ ] `docs/admin-ui-guidelines.md` への使用方法追記
