# shadcn UI 統一化マイグレーション作業

## 概要

admin アプリケーションのUIコンポーネントを shadcn UI に統一する。
現在、カスタムUI・shadcn UI・生HTMLが混在している状態を解消する。

## 現状

### コンポーネント使用状況

| 種類 | 状態 |
|------|------|
| shadcn UI | 新規コンポーネントで使用開始 |
| カスタム UI | `Button.tsx`, `Input.tsx`, `Card.tsx`, `Selector.tsx` が残存 |
| 生 HTML | 複数ファイルで `<button>`, `<input>` を直接使用 |

## マイグレーション対象

### 1. カスタムUIコンポーネントを使用しているファイル

直接importしているファイル:

| ファイル | 使用コンポーネント |
|----------|-------------------|
| `counterpart-assignment/CounterpartAssignmentClient.tsx` | `Card`, `Selector`, `Input` |
| `xml-export/XmlExportClient.tsx` | `Card`, `Button`, `Input`, `Selector` |

index.ts経由でカスタムUIを使用:

| ファイル | 使用コンポーネント |
|----------|-------------------|
| `balance-snapshots/BalanceSnapshotForm.tsx` | `Button` |
| `csv-upload/CsvUploadClient.tsx` | `Selector` |
| `balance-snapshots/BalanceSnapshotsClient.tsx` | `Selector` |
| `transactions/TransactionsClient.tsx` | `Selector` |

### 2. 生 HTML を使用しているファイル（カスタムダイアログ）

shadcn `Dialog` への移行が必要:

| ファイル | 対応内容 |
|----------|----------|
| `counterparts/CreateCounterpartDialog.tsx` | `Dialog` コンポーネントへ移行 |
| `counterparts/EditCounterpartDialog.tsx` | `Dialog` コンポーネントへ移行 |
| `counterpart-assignment/BulkAssignModal.tsx` | `Dialog` コンポーネントへ移行 |

### 3. 生 HTML を使用しているファイル（input/button）

| ファイル | 対応内容 |
|----------|----------|
| `counterpart-assignment/CounterpartAssignmentClient.tsx` | `ShadcnInput`, `ShadcnButton` へ |
| `counterpart-assignment/TransactionWithCounterpartTable.tsx` | `Checkbox` へ |
| `counterpart-assignment/CounterpartCombobox.tsx` | `ShadcnInput`, `ShadcnButton` へ |
| `counterparts/CounterpartMasterClient.tsx` | `ShadcnInput`, `ShadcnButton` へ |
| `counterparts/CounterpartTable.tsx` | `ShadcnButton` へ |
| `counterparts/DeleteCounterpartButton.tsx` | `ShadcnButton` へ |
| `transactions/ClearWebappCacheButton.tsx` | `ShadcnButton` へ |
| `transactions/DeleteAllButton.tsx` | `ShadcnButton` へ |
| `csv-import/CsvPreview.tsx` | `ShadcnButton` へ |
| `csv-upload/CsvUploadClient.tsx` | `ShadcnInput` へ |
| `balance-snapshots/BalanceSnapshotForm.tsx` | `ShadcnInput` へ |
| `balance-snapshots/BalanceSnapshotList.tsx` | `ShadcnButton` へ |
| `ui/ClientPagination.tsx` | `ShadcnButton` へ |

## 作業手順

### Phase 1: Selector の移行

`Selector` は shadcn `Select` に対応。

**方針**: ラッパーコンポーネントは作成せず、各呼び出し箇所を直接 shadcn Select の形式に書き換える。
`Selector` の機能は単純（value/onChange/options/label/placeholder）なため、個別対応で問題ない。

```tsx
// Before (Selector)
<Selector value={v} onChange={setV} options={opts} label="団体" />

// After (shadcn Select)
<div>
  <Label>団体</Label>
  <Select value={v} onValueChange={setV}>
    <SelectTrigger>
      <SelectValue placeholder="選択してください" />
    </SelectTrigger>
    <SelectContent>
      {opts.map(o => <SelectItem key={o.value} value={o.value}>{o.label}</SelectItem>)}
    </SelectContent>
  </Select>
</div>
```

移行対象:
- [ ] `csv-upload/CsvUploadClient.tsx`
- [ ] `balance-snapshots/BalanceSnapshotsClient.tsx`
- [ ] `transactions/TransactionsClient.tsx`
- [ ] `counterpart-assignment/CounterpartAssignmentClient.tsx`
- [ ] `xml-export/XmlExportClient.tsx`

完了後、`Selector.tsx` を削除。

### Phase 2: Button の移行

`Button` → `ShadcnButton` に移行:
- [ ] `balance-snapshots/BalanceSnapshotForm.tsx`
- [ ] `xml-export/XmlExportClient.tsx`
- [ ] 生 `<button>` を使用しているファイル（上記一覧参照）

完了後、`Button.tsx` を削除。

### Phase 3: Input の移行

`Input` → `ShadcnInput` に移行:
- [ ] `counterpart-assignment/CounterpartAssignmentClient.tsx`
- [ ] `xml-export/XmlExportClient.tsx`
- [ ] 生 `<input>` を使用しているファイル（上記一覧参照）

完了後、`Input.tsx` を削除。

### Phase 4: Card の移行

`Card` → `ShadcnCard` に移行:
- [ ] `counterpart-assignment/CounterpartAssignmentClient.tsx`
- [ ] `xml-export/XmlExportClient.tsx`

完了後、`Card.tsx` を削除。

### Phase 5: Dialog への移行

カスタムモーダル → shadcn `Dialog` に移行:
- [ ] `counterparts/CreateCounterpartDialog.tsx`
- [ ] `counterparts/EditCounterpartDialog.tsx`
- [ ] `counterpart-assignment/BulkAssignModal.tsx`

### Phase 6: クリーンアップ

- [ ] `index.ts` から非推奨エクスポートを削除
- [ ] `Shadcn` プレフィックスを外す（`ShadcnButton` → `Button` 等）
- [ ] カラー変数の統一（`primary-*` → shadcn標準変数）

## 注意事項

- 各Phaseごとに動作確認を行う
- 既存の見た目・挙動が変わらないことを確認
- テストがある場合は実行して pass することを確認

## 完了条件

- [ ] カスタムUIファイル（`Button.tsx`, `Input.tsx`, `Card.tsx`, `Selector.tsx`）が削除されている
- [ ] 全コンポーネントが `@/client/components/ui` の index.ts 経由で import されている
- [ ] 生 HTML の `<button>`, `<input>` が UI コンポーネント外に存在しない
- [ ] カスタムモーダル実装が存在しない
